# CrowdSec User-Agent Blacklist Scenario
type: trigger
name: custom/http-bad-user-agent
description: "Detect usage of bad User Agent (Local List)"
filter: "evt.Meta.log_type == 'traefik' && (RegexpInFile(evt.Parsed.request_User_Agent, 'user-agent-blacklist.regex.txt') || RegexpInFile(evt.Parsed['request_User-Agent'], 'user-agent-blacklist.regex.txt'))"
groupby: "evt.Meta.source_ip"
blackhole: 1m
labels:
  service: http
  remediation: true
data:
  - dest_file: user-agent-blacklist.regex.txt
    type: regexp
