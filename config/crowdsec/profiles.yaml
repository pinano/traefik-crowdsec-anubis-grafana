# =============================================================================
# CrowdSec Profiles - Aggressive Ban Configuration
# =============================================================================
# This file overrides the default profiles to apply longer ban durations
# and implements a "repeat offender" escalation policy.
#
# Profile order matters: first matching profile wins.
# =============================================================================

# -----------------------------------------------------------------------------
# Profile 1: Repeat Offenders (7-day ban)
# -----------------------------------------------------------------------------
# If an IP triggers multiple alerts (>5 events), apply a 7-day ban.
# This catches persistent attackers who keep probing after initial bans.

name: repeat_offender
filters:
 - Alert.Remediation == true && Alert.GetScope() == "Ip" && len(Alert.Events) > 5
decisions:
 - type: ban
   duration: 168h  # 7 days
on_success: break

---

# -----------------------------------------------------------------------------
# Profile 2: Standard Aggressive Ban (24 hours)
# -----------------------------------------------------------------------------
# Default ban duration increased from 4h to 24h for all IP-based remediation.

name: aggressive_ban
filters:
 - Alert.Remediation == true && Alert.GetScope() == "Ip"
decisions:
 - type: ban
   duration: 24h   # 24 hours (default is 4h)
on_success: break

---

# -----------------------------------------------------------------------------
# Profile 3: Range-based Attacks (48 hours)
# -----------------------------------------------------------------------------
# If the attack targets a range (subnet), apply a 48-hour ban to the range.

name: range_ban
filters:
 - Alert.Remediation == true && Alert.GetScope() == "Range"
decisions:
 - type: ban
   duration: 48h
on_success: break
